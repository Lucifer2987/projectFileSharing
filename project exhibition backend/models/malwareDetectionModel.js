const fs = require('fs');
const path = require('path');
const { RandomForestClassifier } = require('sklearn');

const malwareDetectionDatasetPath = path.join(__dirname, '../datasets/malwaredetection.csv');

const trainMalwareModel = () => {
  const data = fs.readFileSync(malwareDetectionDatasetPath, 'utf8');
  const dataset = data.split('\n').map((row) => row.split(','));
  const X = dataset.map((row) => row.slice(0, -1).map(Number));
  const y = dataset.map((row) => row.slice(-1)[0]);

  const clf = new RandomForestClassifier();
  clf.fit(X, y);
  return clf;
};

module.exports = trainMalwareModel;
